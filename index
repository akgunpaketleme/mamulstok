<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√úretim ve Stok Takip Sistemi</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Lucide ikonlarƒ± i√ßin basit SVG'ler
        const Plus = () => <span>‚ûï</span>;
        const Edit2 = () => <span>‚úèÔ∏è</span>;
        const Send = () => <span>üì§</span>;
        const PackageCheck = () => <span>‚úÖ</span>;
        const Truck = () => <span>üöö</span>;

        const UretimTakipSistemi = () => {
          const [urunler, setUrunler] = useState([]);
          const [hareketler, setHareketler] = useState([]);
          const [aktifSekme, setAktifSekme] = useState('stok');
          const [modalAcik, setModalAcik] = useState(false);
          const [islemTipi, setIslemTipi] = useState('');
          const [secilenUrun, setSecilenUrun] = useState(null);
          const [yeniUrunModalAcik, setYeniUrunModalAcik] = useState(false);
          const [yeniUrunAdi, setYeniUrunAdi] = useState('');

          useEffect(() => {
            const kaydedilmisUrunler = localStorage.getItem('urunler');
            const kaydedilmisHareketler = localStorage.getItem('hareketler');
            
            if (kaydedilmisUrunler) {
              setUrunler(JSON.parse(kaydedilmisUrunler));
            }
            if (kaydedilmisHareketler) {
              setHareketler(JSON.parse(kaydedilmisHareketler));
            }
          }, []);

          useEffect(() => {
            if (urunler.length > 0) {
              localStorage.setItem('urunler', JSON.stringify(urunler));
            }
          }, [urunler]);

          useEffect(() => {
            if (hareketler.length > 0) {
              localStorage.setItem('hareketler', JSON.stringify(hareketler));
            }
          }, [hareketler]);

          const yeniUrunEkle = () => {
            if (!yeniUrunAdi.trim()) {
              alert('L√ºtfen √ºr√ºn adƒ± girin');
              return;
            }
            const yeniUrun = {
              id: Date.now(),
              ad: yeniUrunAdi,
              temizlemeStokuA: 0,
              temizlemeStokuB: 0,
              temizlemedekiA: 0,
              temizlemedekiB: 0,
              temizlemedekiKg: 0,
              paketlenecekA: 0,
              paketlenecekB: 0,
              paketlendi: 0,
              paketlendiKoli: 0,
              toplamHurda: 0
            };
            setUrunler([...urunler, yeniUrun]);
            setYeniUrunModalAcik(false);
            setYeniUrunAdi('');
          };

          const hareketEkle = (urunId, islem, detaylar, kullanici = 'Sistem') => {
            const hareket = {
              id: Date.now(),
              tarih: new Date().toLocaleString('tr-TR'),
              urunId,
              urunAd: urunler.find(u => u.id === urunId)?.ad,
              islem,
              detaylar,
              kullanici
            };
            setHareketler([hareket, ...hareketler]);
          };

          const urunGuncelle = (urunId, guncellemeler) => {
            setUrunler(urunler.map(urun => 
              urun.id === urunId ? { ...urun, ...guncellemeler } : urun
            ));
          };

          const islemYap = (data) => {
            const urun = urunler.find(u => u.id === secilenUrun.id);
            
            switch (islemTipi) {
              case 'temizlemeStoku':
                const ekleA = data.islem === 'ekle';
                const adetA = parseInt(data.adetA || 0);
                const adetB = parseInt(data.adetB || 0);
                
                urunGuncelle(urun.id, {
                  temizlemeStokuA: ekleA ? urun.temizlemeStokuA + adetA : urun.temizlemeStokuA - adetA,
                  temizlemeStokuB: ekleA ? urun.temizlemeStokuB + adetB : urun.temizlemeStokuB - adetB
                });
                hareketEkle(urun.id, 'Temizleme Stoƒüu D√ºzenleme', 
                  `${ekleA ? 'Eklendi' : '√áƒ±karƒ±ldƒ±'} - A: ${adetA}, B: ${adetB}`, 
                  data.kullanici);
                break;
                
              case 'temizlemeyeGonder':
                const gonderilecekA = parseInt(data.adetA || 0);
                const gonderilecekB = parseInt(data.adetB || 0);
                const gonderilecekKg = parseFloat(data.kg || 0);
                
                urunGuncelle(urun.id, {
                  temizlemeStokuA: urun.temizlemeStokuA - gonderilecekA,
                  temizlemeStokuB: urun.temizlemeStokuB - gonderilecekB,
                  temizlemedekiA: urun.temizlemedekiA + gonderilecekA,
                  temizlemedekiB: urun.temizlemedekiB + gonderilecekB,
                  temizlemedekiKg: urun.temizlemedekiKg + gonderilecekKg
                });
                hareketEkle(urun.id, 'Temizlemeye G√∂nderildi', 
                  `A: ${gonderilecekA}, B: ${gonderilecekB}, ${gonderilecekKg} kg`, 
                  data.kullanici);
                break;
                
              case 'temizlemeDondu':
                const donenA = parseInt(data.adetA || 0);
                const donenB = parseInt(data.adetB || 0);
                const donenKg = parseFloat(data.kg || 0);
                
                urunGuncelle(urun.id, {
                  temizlemedekiA: urun.temizlemedekiA - donenA,
                  temizlemedekiB: urun.temizlemedekiB - donenB,
                  temizlemedekiKg: urun.temizlemedekiKg - donenKg,
                  paketlenecekA: urun.paketlenecekA + donenA,
                  paketlenecekB: urun.paketlenecekB + donenB
                });
                hareketEkle(urun.id, 'Temizlemeden D√∂nd√º', 
                  `A: ${donenA}, B: ${donenB}, ${donenKg} kg`, 
                  data.kullanici);
                break;
                
              case 'paketleme':
                const paketlenenAdet = parseInt(data.adet || 0);
                const paketlenenKoli = parseInt(data.koli || 0);
                const hurdaAdet = parseInt(data.hurda || 0);
                const tekrarTemizlenecek = parseInt(data.tekrarTemizleme || 0);
                
                urunGuncelle(urun.id, {
                  paketlenecekA: urun.paketlenecekA - paketlenenAdet - hurdaAdet - tekrarTemizlenecek,
                  paketlenecekB: urun.paketlenecekB - paketlenenAdet - hurdaAdet - tekrarTemizlenecek,
                  paketlendi: urun.paketlendi + paketlenenAdet,
                  paketlendiKoli: urun.paketlendiKoli + paketlenenKoli,
                  toplamHurda: urun.toplamHurda + hurdaAdet,
                  temizlemeStokuA: urun.temizlemeStokuA + tekrarTemizlenecek,
                  temizlemeStokuB: urun.temizlemeStokuB + tekrarTemizlenecek
                });
                hareketEkle(urun.id, 'Paketleme', 
                  `Paketlenen: ${paketlenenAdet} adet (${paketlenenKoli} koli), Hurda: ${hurdaAdet}, Tekrar Temizleme: ${tekrarTemizlenecek}`, 
                  data.kullanici);
                break;
                
              case 'sevk':
                const sevkAdet = parseInt(data.adet || 0);
                const sevkKoli = parseInt(data.koli || 0);
                
                urunGuncelle(urun.id, {
                  paketlendi: urun.paketlendi - sevkAdet,
                  paketlendiKoli: urun.paketlendiKoli - sevkKoli
                });
                hareketEkle(urun.id, 'Sevk', 
                  `${sevkAdet} adet (${sevkKoli} koli)`, 
                  data.kullanici);
                break;
            }
            
            setModalAcik(false);
          };

          const YeniUrunModal = () => {
            if (!yeniUrunModalAcik) return null;

            return (
              <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div className="bg-white rounded-lg p-6 w-full max-w-md">
                  <h3 className="text-xl font-bold mb-4">üÜï Yeni √úr√ºn Ekle</h3>
                  
                  <div className="mb-4">
                    <label className="block text-sm font-medium mb-1">√úr√ºn Adƒ±</label>
                    <input
                      type="text"
                      className="w-full p-2 border rounded"
                      value={yeniUrunAdi}
                      onChange={(e) => setYeniUrunAdi(e.target.value)}
                      placeholder="√ñrn: √úr√ºn A, Model X, vb."
                      autoFocus
                    />
                  </div>
                  
                  <div className="flex gap-2">
                    <button onClick={yeniUrunEkle} className="flex-1 bg-green-600 text-white py-2 rounded hover:bg-green-700">
                      Ekle
                    </button>
                    <button onClick={() => { setYeniUrunModalAcik(false); setYeniUrunAdi(''); }} 
                      className="flex-1 bg-gray-300 py-2 rounded hover:bg-gray-400">
                      ƒ∞ptal
                    </button>
                  </div>
                </div>
              </div>
            );
          };

          const IslemModal = () => {
            const [formData, setFormData] = useState({});
            
            const formAlanlari = {
              temizlemeStoku: [
                { name: 'islem', label: 'ƒ∞≈ülem Tipi', type: 'select', options: ['ekle', 'cikar'] },
                { name: 'adetA', label: 'A Adeti', type: 'number' },
                { name: 'adetB', label: 'B Adeti', type: 'number' },
                { name: 'kullanici', label: 'Kaydeden', type: 'text' }
              ],
              temizlemeyeGonder: [
                { name: 'adetA', label: 'G√∂nderilen A Adet', type: 'number', max: secilenUrun?.temizlemeStokuA },
                { name: 'adetB', label: 'G√∂nderilen B Adet', type: 'number', max: secilenUrun?.temizlemeStokuB },
                { name: 'kg', label: 'G√∂nderilen Net KG', type: 'number', step: '0.01' },
                { name: 'kullanici', label: 'G√∂nderen', type: 'text' }
              ],
              temizlemeDondu: [
                { name: 'adetA', label: 'D√∂nen A Adet', type: 'number', max: secilenUrun?.temizlemedekiA },
                { name: 'adetB', label: 'D√∂nen B Adet', type: 'number', max: secilenUrun?.temizlemedekiB },
                { name: 'kg', label: 'D√∂nen Net KG', type: 'number', step: '0.01' },
                { name: 'kullanici', label: 'Kaydeden', type: 'text' }
              ],
              paketleme: [
                { name: 'adet', label: 'Paketlenen Adet', type: 'number', 
                  max: Math.min(secilenUrun?.paketlenecekA || 0, secilenUrun?.paketlenecekB || 0) },
                { name: 'koli', label: 'Paketlenen Koli Adeti', type: 'number' },
                { name: 'hurda', label: 'Hurda Adet', type: 'number' },
                { name: 'tekrarTemizleme', label: 'Tekrar Temizlenecek Adet', type: 'number' },
                { name: 'kullanici', label: 'Paketleyen', type: 'text' }
              ],
              sevk: [
                { name: 'adet', label: 'Sevk Edilen √úr√ºn Adeti', type: 'number', max: secilenUrun?.paketlendi },
                { name: 'koli', label: 'Sevk Edilen Koli Adeti', type: 'number', max: secilenUrun?.paketlendiKoli },
                { name: 'kullanici', label: 'Sevk Eden', type: 'text' }
              ]
            };

            const basliklar = {
              temizlemeStoku: 'üìù Temizleme Stoƒüu D√ºzenle',
              temizlemeyeGonder: 'üöö Temizlemeye G√∂nder',
              temizlemeDondu: '‚úÖ Temizlemeden D√∂nd√º',
              paketleme: 'üì¶ Paketleme',
              sevk: 'üöõ Sevk'
            };

            const handleKaydet = () => {
              const alanlar = formAlanlari[islemTipi];
              let valid = true;
              
              for (let alan of alanlar) {
                if (!formData[alan.name]) {
                  alert(`L√ºtfen ${alan.label} alanƒ±nƒ± doldurun`);
                  valid = false;
                  break;
                }
              }
              
              if (valid) {
                islemYap(formData);
                setFormData({});
              }
            };

            if (!modalAcik) return null;

            return (
              <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div className="bg-white rounded-lg p-6 w-full max-w-md">
                  <h3 className="text-xl font-bold mb-4">{basliklar[islemTipi]}</h3>
                  <p className="text-gray-600 mb-4">√úr√ºn: <strong>{secilenUrun?.ad}</strong></p>
                  
                  <div>
                    {formAlanlari[islemTipi]?.map(alan => (
                      <div key={alan.name} className="mb-4">
                        <label className="block text-sm font-medium mb-1">{alan.label}</label>
                        {alan.type === 'select' ? (
                          <select
                            className="w-full p-2 border rounded"
                            value={formData[alan.name] || ''}
                            onChange={(e) => setFormData({...formData, [alan.name]: e.target.value})}
                          >
                            <option value="">Se√ßin...</option>
                            {alan.options.map(opt => (
                              <option key={opt} value={opt}>
                                {opt === 'ekle' ? 'Ekle (+)' : opt === 'cikar' ? '√áƒ±kar (-)' : opt}
                              </option>
                            ))}
                          </select>
                        ) : (
                          <input
                            type={alan.type}
                            step={alan.step}
                            className="w-full p-2 border rounded"
                            value={formData[alan.name] || ''}
                            onChange={(e) => setFormData({...formData, [alan.name]: e.target.value})}
                            max={alan.max}
                          />
                        )}
                        {alan.max !== undefined && <p className="text-xs text-gray-500 mt-1">Maksimum: {alan.max}</p>}
                      </div>
                    ))}
                    
                    <div className="flex gap-2 mt-6">
                      <button onClick={handleKaydet} className="flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
                        Kaydet
                      </button>
                      <button onClick={() => { setModalAcik(false); setFormData({}); }} 
                        className="flex-1 bg-gray-300 py-2 rounded hover:bg-gray-400">
                        ƒ∞ptal
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            );
          };

          return (
            <div className="min-h-screen bg-gray-50 p-6">
              <div className="max-w-7xl mx-auto">
                <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                  <h1 className="text-3xl font-bold text-gray-800 mb-2">√úretim ve Stok Takip Sistemi</h1>
                  <p className="text-gray-600">Ger√ßek zamanlƒ± √ºretim ve stok y√∂netimi</p>
                </div>

                <div className="flex gap-2 mb-6">
                  <button
                    onClick={() => setAktifSekme('stok')}
                    className={`px-6 py-2 rounded-lg font-medium ${
                      aktifSekme === 'stok' ? 'bg-blue-600 text-white' : 'bg-white text-gray-700'
                    }`}
                  >
                    üìä Stok Durumu
                  </button>
                  <button
                    onClick={() => setAktifSekme('hareketler')}
                    className={`px-6 py-2 rounded-lg font-medium ${
                      aktifSekme === 'hareketler' ? 'bg-blue-600 text-white' : 'bg-white text-gray-700'
                    }`}
                  >
                    üìú Ge√ßmi≈ü Hareketler
                  </button>
                  <button
                    onClick={() => setYeniUrunModalAcik(true)}
                    className="ml-auto px-6 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700"
                  >
                    <Plus /> Yeni √úr√ºn Ekle
                  </button>
                </div>

                {aktifSekme === 'stok' && (
                  <div className="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div className="overflow-x-auto">
                      <table className="w-full text-sm">
                        <thead className="bg-gray-100">
                          <tr>
                            <th className="px-3 py-3 text-left">√úr√ºn</th>
                            <th className="px-3 py-3 text-center bg-yellow-50" colSpan="2">Temizleme Stoƒüu</th>
                            <th className="px-3 py-3 text-center bg-blue-50" colSpan="3">Temizlemede</th>
                            <th className="px-3 py-3 text-center bg-purple-50" colSpan="2">Paketlenecek</th>
                            <th className="px-3 py-3 text-center bg-green-50" colSpan="2">Paketlendi</th>
                            <th className="px-3 py-3 text-center text-red-600">Hurda</th>
                            <th className="px-3 py-3 text-center">ƒ∞≈ülemler</th>
                          </tr>
                          <tr className="text-xs bg-gray-50">
                            <th className="px-3 py-2"></th>
                            <th className="px-3 py-2 bg-yellow-50">A</th>
                            <th className="px-3 py-2 bg-yellow-50">B</th>
                            <th className="px-3 py-2 bg-blue-50">A</th>
                            <th className="px-3 py-2 bg-blue-50">B</th>
                            <th className="px-3 py-2 bg-blue-50">KG</th>
                            <th className="px-3 py-2 bg-purple-50">A</th>
                            <th className="px-3 py-2 bg-purple-50">B</th>
                            <th className="px-3 py-2 bg-green-50">Adet</th>
                            <th className="px-3 py-2 bg-green-50">Koli</th>
                            <th className="px-3 py-2"></th>
                            <th className="px-3 py-2"></th>
                          </tr>
                        </thead>
                        <tbody>
                          {urunler.length === 0 ? (
                            <tr>
                              <td colSpan="12" className="text-center py-8 text-gray-500">
                                Hen√ºz √ºr√ºn eklenmemi≈ü. "Yeni √úr√ºn Ekle" butonuna tƒ±klayƒ±n.
                              </td>
                            </tr>
                          ) : (
                            urunler.map(urun => {
                              const paketYapilabilir = Math.min(urun.paketlenecekA, urun.paketlenecekB);
                              return (
                                <tr key={urun.id} className="border-b hover:bg-gray-50">
                                  <td className="px-3 py-3 font-medium">{urun.ad}</td>
                                  <td className="px-3 py-3 text-center bg-yellow-50">{urun.temizlemeStokuA}</td>
                                  <td className="px-3 py-3 text-center bg-yellow-50">{urun.temizlemeStokuB}</td>
                                  <td className="px-3 py-3 text-center bg-blue-50">{urun.temizlemedekiA}</td>
                                  <td className="px-3 py-3 text-center bg-blue-50">{urun.temizlemedekiB}</td>
                                  <td className="px-3 py-3 text-center bg-blue-50">{(urun.temizlemedekiKg || 0).toFixed(2)}</td>
                                  <td className="px-3 py-3 text-center bg-purple-50">{urun.paketlenecekA}</td>
                                  <td className="px-3 py-3 text-center bg-purple-50">{urun.paketlenecekB}</td>
                                  <td className="px-3 py-3 text-center bg-green-50 font-bold">{urun.paketlendi}</td>
                                  <td className="px-3 py-3 text-center bg-green-50 font-bold">{urun.paketlendiKoli}</td>
                                  <td className="px-3 py-3 text-center text-red-600 font-medium">{urun.toplamHurda}</td>
                                  <td className="px-3 py-3">
                                    <div className="flex flex-col gap-1">
                                      <button onClick={() => { setSecilenUrun(urun); setIslemTipi('temizlemeStoku'); setModalAcik(true); }}
                                        className="text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded hover:bg-yellow-200 flex items-center gap-1 justify-center">
                                        <Edit2 /> Tem. Stok
                                      </button>
                                      <button onClick={() => { setSecilenUrun(urun); setIslemTipi('temizlemeyeGonder'); setModalAcik(true); }}
                                        className="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200 flex items-center gap-1 justify-center"
                                        disabled={urun.temizlemeStokuA === 0 && urun.temizlemeStokuB === 0}>
                                        <Send /> G√∂nder
                                      </button>
                                      <button onClick={() => { setSecilenUrun(urun); setIslemTipi('temizlemeDondu'); setModalAcik(true); }}
                                        className="text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded hover:bg-purple-200 flex items-center gap-1 justify-center"
                                        disabled={urun.temizlemedekiA === 0 && urun.temizlemedekiB === 0}>
                                        <PackageCheck /> D√∂nd√º
                                      </button>
                                      <button onClick={() => { setSecilenUrun(urun); setIslemTipi('paketleme'); setModalAcik(true); }}
                                        className="text-xs bg-orange-100 text-orange-700 px-2 py-1 rounded hover:bg-orange-200 flex items-center gap-1 justify-center"
                                        disabled={paketYapilabilir === 0}>
                                        üì¶ Paketleme
                                      </button>
                                      <button onClick={() => { setSecilenUrun(urun); setIslemTipi('sevk'); setModalAcik(true); }}
                                        className="text-xs bg-green-100 text-green-700 px-2 py-1 rounded hover:bg-green-200 flex items-center gap-1 justify-center"
                                        disabled={urun.paketlendi === 0}>
                                        <Truck /> Sevk
                                      </button>
                                    </div>
                                  </td>
                                </tr>
                              );
                            })
                          )}
                        </tbody>
                      </table>
                    </div>
                  </div>
                )}

                {aktifSekme === 'hareketler' && (
                  <div className="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div className="p-4 bg-gray-50 border-b">
                      <h2 className="text-xl font-bold">Ge√ßmi≈ü Hareketler</h2>
                    </div>
                    <div className="overflow-x-auto max-h-96">
                      <table className="w-full">
                        <thead className="bg-gray-100 sticky top-0">
                          <tr>
                            <th className="px-4 py-2 text-left">Tarih</th>
                            <th className="px-4 py-2 text-left">√úr√ºn</th>
                            <th className="px-4 py-2 text-left">ƒ∞≈ülem</th>
                            <th className="px-4 py-2 text-left">Detaylar</th>
                            <th className="px-4 py-2 text-left">Kullanƒ±cƒ±</th>
                          </tr>
                        </thead>
                        <tbody>
                          {hareketler.length === 0 ? (
                            <tr>
                              <td colSpan="5" className="text-center py-8 text-gray-500">
                                Hen√ºz hareket kaydƒ± yok.
                              </td>
                            </tr>
                          ) : (
                            hareketler.map(hareket => (
                              <tr key={hareket.id} className="border-b hover:bg-gray-50">
                                <td className="px-4 py-2 text-sm">{hareket.tarih}</td>
                                <td className="px-4 py-2 font-medium">{hareket.urunAd}</td>
                                <td className="px-4 py-2">
                                  <span className="px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm">
                                    {hareket.islem}
                                  </span>
                                </td>
                                <td className="px-4 py-2 text-sm">{hareket.detaylar}</td>
                                <td className="px-4 py-2 text-sm">{hareket.kullanici}</td>
                              </tr>
                            ))
                          )}
                        </tbody>
                      </table>
                    </div>
                  </div>
                )}

                <YeniUrunModal />
                <IslemModal />
              </div>
            </div>
          );
        };

        ReactDOM.render(<UretimTakipSistemi />, document.getElementById('root'));
    </script>
</body>
</html>
